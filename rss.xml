<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"
    xmlns:dc="http://purl.org/dc/elements/1.1/">
    <channel>
        <title>ChubaDuba - Все посты</title>
        <link>https://chubaduba.github.io/</link>
        <description><![CDATA[Блог ChubaDuba]]></description>
        <atom:link href="https://chubaduba.github.io//rss.xml" rel="self"
                   type="application/rss+xml" />
        <lastBuildDate>Fri, 15 Jun 2018 00:00:00 UT</lastBuildDate>
        <item>
    <title>Русская консоль (tty) в Debian 9 Stratch i386</title>
    <link>https://chubaduba.github.io//posts/2018-06-15-1.html</link>
    <description><![CDATA[<p>Сразу отмечу, что баг был замечен при неоднократных установках Debian. Во всех случаях использовался образ диска <code>netinstall</code>, устанавливалась минимальная конфигурация без графического интерфейса. Проявляется баг только на дистрибутиве <code>Debian 9 Stratch i386</code>, на 64-х битной версии он отсутствует. Заключается он в некорректном отображении кириллицы (вместо букв квадраты) при правильно сконфигурированной русской локали.</p>
<p>Проблема решилась после изменения юнита <code>systemd</code> под названием <code>console-setup.service</code>. Расположен он в <code>/etc/systemd/system/multi-user.target.wants/</code>. Вот его содержимое по умолчанию:</p>
<pre><code>[Unit]
Description=Set console font and keymap
DefaultDependencies=no
After=console-screen.service kbd.service local-fs.target
RequiresMountsFor=/usr
ConditionPathExists=/bin/setupcon

[Service]
Type=oneshot
ExecStart=/lib/console-setup/console-setup.sh
RemainAfterExit=yes

[Install]
WantedBy=multi-user.target
</code></pre>
<p>Нужно изменить одну строчку:</p>
<pre><code>ExecStart=/lib/console-setup/console-setup.sh
</code></pre>
<p>на</p>
<pre><code>ExecStart=/bin/setupcon
</code></pre>
<p>После перезапуска юнита всё встаёт на свои места, и в консоли теперь русские буквы отображаются корректно.</p>]]></description>
    <pubDate>Fri, 15 Jun 2018 00:00:00 UT</pubDate>
    <guid>https://chubaduba.github.io//posts/2018-06-15-1.html</guid>
    <dc:creator>ChubaDuba</dc:creator>
</item>
<item>
    <title>Xmonad. Загоняем калькулятор в Prompt.</title>
    <link>https://chubaduba.github.io//posts/2018-06-04-1.html</link>
    <description><![CDATA[<p>Давно хотелось сделать работу с калькулятором в xmonad удобной. Чтобы он был всегда под рукой, и чтобы не делать лишних телодвижений с окном программы.</p>
<p>В своей системе я пользуюсь консольным калькулятором <a href="http://www.isthe.com/chongo/tech/comp/calc/calc-mirror.html">Calc</a>. Было найдено оригинальное решение, которое позволяет расположить калькулятор в строке ввода команд <code>Prompt</code>. Что такое <code>Prompt</code> и как это работает, я уже <a href="https://chubaduba.github.io/posts/2018-04-19-1.html">писал раньше</a>.</p>
<p>Все изменения будем делать в файле конфигурации xmonad <code>xmonad.hs</code>. Первое, что я сделал - сконфигурировал саму строку ввода, в которой будет открываться калькулятор:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">-- Calc Prompt</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">myCalcConfig <span class="fu">=</span> def</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">        { font                <span class="fu">=</span> myFont</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">        , bgColor             <span class="fu">=</span> <span class="st">&quot;#1E2320&quot;</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">        , fgColor             <span class="fu">=</span> <span class="st">&quot;#DBA3A2&quot;</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">        , promptBorderWidth   <span class="fu">=</span> <span class="dv">0</span> </a>
<a class="sourceLine" id="cb1-7" data-line-number="7">        , position            <span class="fu">=</span> <span class="dt">Top</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8">        }</a></code></pre></div>
<p>Тут всё просто. Задал шрифт, цвет фона и цвет шрифта, а также месторасположение строки. В моём случае окно калькулятора будет распологаться вверху экрана, перекрывая <code>xmobar</code>.</p>
<p>Вторым шагом добавляем саму функцию, которая будет открывать калькулятор:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">-- Calculator</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="ot">calcPrompt ::</span> <span class="dt">XPConfig</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">X</span> () </a>
<a class="sourceLine" id="cb2-3" data-line-number="3">calcPrompt c ans <span class="fu">=</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">    inputPrompt c (trim ans) <span class="fu">?+</span> \input <span class="ot">-&gt;</span> </a>
<a class="sourceLine" id="cb2-5" data-line-number="5">        liftIO(runProcessWithInput <span class="st">&quot;calc&quot;</span> [input] <span class="st">&quot;&quot;</span>) <span class="fu">&gt;&gt;=</span> calcPrompt c </a>
<a class="sourceLine" id="cb2-6" data-line-number="6">    <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">        trim  <span class="fu">=</span> f <span class="fu">.</span> f</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">            <span class="kw">where</span> f <span class="fu">=</span> reverse <span class="fu">.</span> dropWhile isSpace</a></code></pre></div>
<p>И последнее, что нужно сделать, это добавить в конфигурационный файл комбинацию клавиш, при нажатии которой будет открываться калькулятор:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" data-line-number="1">, ((mod4Mask,     xK_c), calcPrompt myCalcConfig <span class="st">&quot;calc&quot;</span>)</a></code></pre></div>
<p>Теперь при нажатии клавиш <code>mod4 + c</code> на месте <code>xmobar</code> открывается окно калькулятора. Закрыть его можно, нажав кнопку <code>Esc</code>.</p>
<p><img src="http://images2.imagebam.com/b9/e6/76/20f91e885153304.png" /></p>]]></description>
    <pubDate>Mon, 04 Jun 2018 00:00:00 UT</pubDate>
    <guid>https://chubaduba.github.io//posts/2018-06-04-1.html</guid>
    <dc:creator>ChubaDuba</dc:creator>
</item>
<item>
    <title>Использование сервиса pastebin.</title>
    <link>https://chubaduba.github.io//posts/2018-05-28-1.html</link>
    <description><![CDATA[<p>Очень часто, при решении каких-то вопросов, связанных с использованием Linux, люди, пытающиеся вам помочь, просят, чтобы вы показали им какой-либо файл с логами или результат работы (выхлоп) команды, введённой в терминале. Первое, что придёт вам на ум в этой ситуации - это сделать скриншот своего экрана или вообще взять и сфотографировать свой монитор. Согласистесь, очень часто на форумах, на которых пользователи Linux ищут ответы на свои вопросы можно увидеть вот такие фотографии:</p>
<p><img src="http://images2.imagebam.com/1f/95/29/9c2c63827428223.JPG" /></p>
<p>Хорошо, если фотография хорошего качества, вся информация полностью умещается на мониторе и удобно читаемая. Но такое бывает далеко не всегда. Сегодня речь пойдёт о работе с сервисом <code>pasebin</code>, который позволяет загружать отрывки текста, фрагменты исходного кода и т.д. для возможности просмотра окружающими.</p>
<p>Для работы с сервисом установим в нашу систему два пакета <a href="https://packages.debian.org/stretch/pastebinit">pastebinit</a> и <a href="https://packages.debian.org/stretch/xclip">xclip</a>. <code>pastebinit</code> - это инструмент командной строки для отправки данных на сайт, который позволяет пользователям размещать отрывки текста для публичного просмотра, а <code>xclip</code> — это утилита, предоставляющая интерфейс к буферу обмена из командной строки:</p>
<pre><code>$ sudo apt-get install pastebinit
$ sudo apt-get install xclip
</code></pre>
<p>Чтобы посмотреть с какими сервисами работает <code>pastebinit</code>, нужно в терминале ввести команду:</p>
<pre><code>$ pastebinit -l
</code></pre>
<p><img src="http://images2.imagebam.com/c5/d4/44/88c0c8851554954.png" /></p>
<p>Стоит отметить, что на самом деле, не со всеми сервисами из этого списка <code>pastebinit</code> работает. Причины этому две: либо сам сервис не работает (недоступен), либо у сервиса поменялся API и <code>pastebinit</code> перестал корректно с ним работать. Какой сервис выбрать для себя дело сугубо ваших предпочтений. Я пользуюсь сервисом по умолчанию <code>paste.debian.net</code>.</p>
<blockquote>
<p>В Debian 9 Stratch <code>pastebinit</code> имеет ошибки, которые не позволяют ему корректно работать с сервисом <code>paste.debian.net</code>. Поэтому рекомендую поставить более свежую версию пакета из Debian testing или Debian sid.</p>
</blockquote>
<p>Чтобы каждый раз не вводить в терминале длинные команды, создадим <code>alias</code>, обзовём его <code>paste</code>, который будем использовать когда нужно будет что-то скопировать. Добавляем в наш файл <code>~/.bashrc</code> строчку :</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="bu">alias</span> paste=<span class="st">&#39;pastebinit -b paste.debian.net -a ChubaDuba | xclip -selection &quot;clipboard&quot; &#39;</span></a></code></pre></div>
<p>параметр <code>-a</code> задаёт имя автора. Параметр не обязательный, если вы его не будите прописывать, то автоматически вам будет присвоено имя <code>anonymous</code>.</p>
<p>Теперь всё готово для работы. Посмотрим на практике как это работает.<br />
Например, нам нужно показать вывод команды <code>lspci</code>. Открываем терминал и вводим следующую команду:</p>
<pre><code>$ lspci | paste
</code></pre>
<p>После её выполнения в буфере обмена у нас будет ссылка, перейдя по которой можно увидеть результат работы введённой нами команды. В нашем примере <code>lspci</code>. Остаётся поделиться этой ссылкой, нажав клавиши <code>Ctrl + v</code> там, где нам нужно: на форуме, чате или отправить её по e-mail. Если перейти по этой ссылке, откроется страничка выбранного нами ресурса, на которой в удобной для просмотра форме будет показан результат работы вводимой нами команды:</p>
<p><a href="http://www.imagebam.com/image/dffeb7895532484" target="_blank"><img src="http://thumbs2.imagebam.com/e1/fe/50/dffeb7895532484.jpg" alt="imagebam.com"></a></p>]]></description>
    <pubDate>Mon, 28 May 2018 00:00:00 UT</pubDate>
    <guid>https://chubaduba.github.io//posts/2018-05-28-1.html</guid>
    <dc:creator>ChubaDuba</dc:creator>
</item>
<item>
    <title>Xmonad. Middle Column Layout</title>
    <link>https://chubaduba.github.io//posts/2018-05-15-1.html</link>
    <description><![CDATA[<p><code>Middle Column Layout</code> - компоновка окон для xmonad, которая подойдёт владельцам широких экранов.</p>
<p><a href="http://www.imagebam.com/image/0fd3a3855481774" target="_blank"><img src="http://thumbs2.imagebam.com/ad/e6/6a/0fd3a3855481774.jpg" alt="ImageBam image upload"></a></p>
<p><a href="https://github.com/chrissound/XMonadLayouts">Страничка автора на GitHub</a></p>
<p>Демо ролик: <iframe width=100% height="240" src="https://www.youtube.com/embed/e5GTCpzL3OY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></p>]]></description>
    <pubDate>Tue, 15 May 2018 00:00:00 UT</pubDate>
    <guid>https://chubaduba.github.io//posts/2018-05-15-1.html</guid>
    <dc:creator>ChubaDuba</dc:creator>
</item>
<item>
    <title>"Debian stable" wallpaper</title>
    <link>https://chubaduba.github.io//posts/2018-05-13-1.html</link>
    <description><![CDATA[<blockquote>
<p>Debian stable<br />
Installed, configured and forgotten…</p>
</blockquote>
<p><a href="http://www.imagebam.com/image/3b56bd857637814" target="_blank"><img src="http://thumbs2.imagebam.com/9d/a9/fe/3b56bd857637814.jpg" alt="ImageBam image upload"></a></p>]]></description>
    <pubDate>Sun, 13 May 2018 00:00:00 UT</pubDate>
    <guid>https://chubaduba.github.io//posts/2018-05-13-1.html</guid>
    <dc:creator>ChubaDuba</dc:creator>
</item>
<item>
    <title>Xmobar. Дата.</title>
    <link>https://chubaduba.github.io//posts/2018-04-27-1.html</link>
    <description><![CDATA[<p>Выкидываем из <code>~/.xmobarrc</code> стандартный <code>Run Date</code> и вставляем<br />
результат работы скрипта <code>time</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">#!/bin/bash</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="va">DATA=</span><span class="kw">`</span><span class="fu">date</span> <span class="st">&quot;+%d.%m&quot;</span><span class="kw">`</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="va">DAY=</span><span class="kw">`</span><span class="fu">date</span> <span class="st">&quot;+%a&quot;</span><span class="kw">`</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="va">TIME=</span><span class="kw">`</span><span class="fu">date</span> <span class="st">&quot;+%H:%M&quot;</span><span class="kw">`</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">if [[</span> <span class="va">$DAY</span> <span class="ot">=</span> <span class="st">&quot;Сб&quot;</span><span class="kw"> ]]</span>; <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&#39;&lt;fc=#DBA3A2&gt;&#39;</span><span class="va">$DAY</span><span class="st">&#39;&lt;/fc&gt;&#39;</span> \</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="st">&#39;&lt;fc=#84AAD9&gt;&#39;</span><span class="va">$DATA</span><span class="st">&#39;&lt;/fc&gt;&#39;</span>  <span class="st">&#39;&lt;fc=#84AAD9&gt;&#39;</span><span class="va">$TIME</span><span class="st">&#39;&lt;/fc&gt;&#39;</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw">elif [[</span> <span class="va">$DAY</span> <span class="ot">=</span> <span class="st">&quot;Вс&quot;</span><span class="kw"> ]]</span>; <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&#39;&lt;fc=#DBA3A2&gt;&#39;</span><span class="va">$DAY</span><span class="st">&#39;&lt;/fc&gt;&#39;</span> \</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="st">&#39;&lt;fc=#84AAD9&gt;&#39;</span><span class="va">$DATA</span><span class="st">&#39;&lt;/fc&gt;&#39;</span>  <span class="st">&#39;&lt;fc=#84AAD9&gt;&#39;</span><span class="va">$TIME</span><span class="st">&#39;&lt;/fc&gt;&#39;</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="kw">else</span> <span class="bu">echo</span> <span class="st">&#39;&lt;fc=#84AAD9&gt;&#39;</span><span class="va">$DAY</span><span class="st">&#39;&lt;/fc&gt;&#39;</span> <span class="st">&#39;&lt;fc=#84AAD9&gt;&#39;</span><span class="va">$DATA</span><span class="st">&#39;&lt;/fc&gt;&#39;</span>  \</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="st">&#39;&lt;fc=#84AAD9&gt;&#39;</span><span class="va">$TIME</span><span class="st">&#39;&lt;/fc&gt;&#39;</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="kw">fi</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="bu">exit</span> 0</a></code></pre></div>
<p>Вносим изменения в <code>~/.xmobarrc</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="fu">...</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="dt">Run</span> <span class="dt">Com</span> <span class="st">&quot;/путь_до_скрипта/time&quot;</span> [] <span class="st">&quot;time&quot;</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="fu">...</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">, template <span class="fu">=</span> <span class="st">&quot; %StdinReader% }{ ...%time%... }</span></a></code></pre></div>
<p><img src="http://images2.imagebam.com/e8/22/9f/2f0e1b837743753.png" /> <img src="http://images2.imagebam.com/4b/0c/9e/76ea8b838064443.png" /></p>]]></description>
    <pubDate>Fri, 27 Apr 2018 00:00:00 UT</pubDate>
    <guid>https://chubaduba.github.io//posts/2018-04-27-1.html</guid>
    <dc:creator>ChubaDuba</dc:creator>
</item>
<item>
    <title>Xmobar. Информация о текущем треке (MOC плеер).</title>
    <link>https://chubaduba.github.io//posts/2018-04-23-1.html</link>
    <description><![CDATA[<p>Иногда бывает нужно посмотреть имя исполнителя и название трека, который в данный момент воспроизводит ваш аудиоплеер. Ниже приведён скрипт, результатом работы которого является строка, содержащая имя исполнителя и название композиции.</p>
<blockquote>
<p>Скрипт работает только в том случае, если в качестве аудиоплеера вы используете <a href="http://moc.daper.net">MOC</a>.</p>
</blockquote>
<hr />
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">#! /bin/bash</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="va">TCOL=</span><span class="st">&quot;#8C8C8C&quot;</span>    </a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="va">ACOL=</span><span class="st">&quot;#E0AF8F&quot;</span>    </a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="va">DCOL=</span><span class="st">&quot;#637482&quot;</span>    </a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="va">PCOL=</span><span class="st">&quot;#4F4F4F&quot;</span>    </a>
<a class="sourceLine" id="cb1-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="va">MOCSTATE=$(</span><span class="ex">mocp</span> --info <span class="kw">|</span> <span class="fu">head</span> -n 1 <span class="kw">|</span> <span class="fu">tail</span> -c +8<span class="va">)</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="kw">if</span><span class="bu"> [</span> <span class="va">$MOCSTATE</span> <span class="ot">==</span> <span class="st">&quot;PLAY&quot;</span><span class="bu"> ]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">  <span class="co"># MOC на воспроизведении</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12">  <span class="bu">echo</span> <span class="st">&quot;&lt;fc=</span><span class="va">$ACOL</span><span class="st">&gt;</span><span class="va">$(</span><span class="ex">mocp</span> --info <span class="kw">|</span> <span class="fu">tail</span> -n +4 <span class="kw">|</span> <span class="fu">head</span> -n 1 <span class="kw">|</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13">       <span class="fu">tail</span> -c +9<span class="va">)</span><span class="st">&lt;/fc&gt; &lt;fc=</span><span class="va">$DCOL</span><span class="st">&gt;-&lt;/fc&gt; &lt;fc=</span><span class="va">$TCOL</span><span class="st">&gt;</span><span class="va">$(</span><span class="ex">mocp</span> --info <span class="kw">|</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14">       <span class="fu">tail</span> -n +5 <span class="kw">|</span> <span class="fu">head</span> -n 1 <span class="kw">|</span> <span class="fu">tail</span> -c +12<span class="va">)</span><span class="st">&lt;/fc&gt;&quot;</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="kw">elif</span><span class="bu"> [</span> <span class="va">$MOCSTATE</span> <span class="ot">==</span> <span class="st">&quot;PAUSE&quot;</span><span class="bu"> ]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17">  <span class="co"># MOC на паузе</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18">  <span class="bu">echo</span> <span class="st">&quot;&lt;fc=</span><span class="va">$PCOL</span><span class="st">&gt;</span><span class="va">$(</span><span class="ex">mocp</span> --info <span class="kw">|</span> <span class="fu">tail</span> -n +4 <span class="kw">|</span> <span class="fu">head</span> -n 1 <span class="kw">|</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19">       <span class="fu">tail</span> -c +9<span class="va">)</span><span class="st"> - </span><span class="va">$(</span><span class="ex">mocp</span> --info <span class="kw">|</span> <span class="fu">tail</span> -n +5 <span class="kw">|</span> <span class="fu">head</span> -n 1 <span class="kw">|</span> <span class="fu">tail</span> -c +12<span class="va">)</span><span class="st">&lt;/fc&gt;&quot;</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="kw">fi</span></a></code></pre></div>
<hr />
<p><a href="http://www.imagebam.com/image/2fea4c832464493"><img src="http://thumbs2.imagebam.com/7e/0c/a9/2fea4c832464493.jpg" alt="ImageBam image upload"></a></p>]]></description>
    <pubDate>Mon, 23 Apr 2018 00:00:00 UT</pubDate>
    <guid>https://chubaduba.github.io//posts/2018-04-23-1.html</guid>
    <dc:creator>ChubaDuba</dc:creator>
</item>
<item>
    <title>Xmonad. Окно, которое всегда под рукой.</title>
    <link>https://chubaduba.github.io//posts/2018-04-20-1.html</link>
    <description><![CDATA[<p>При работе иногда бывает удобно иметь под рукой какое-нибудь открытое приложение, например, окно терминала, файловый менеджер или любую другую программу, к которой необходим быстрый доступ. В <code>xmonad</code> есть утилита <a href="https://hackage.haskell.org/package/xmonad-contrib-0.13/docs/XMonad-Util-NamedScratchpad.html">XMonad.Util.NamedScratchpad</a>, которая позволяет организовать работу с приложениями таким образом.</p>
<p>Я покажу как работает эта утилита на примере эмулятора терминала <a href="http://software.schmorp.de/pkg/rxvt-unicode.html">urxvt</a> и файлового менеджера <a href="https://ignorantguru.github.io/spacefm/">SpaceFM</a>.</p>
<p>Добавляем утилиту в наш конфигурационный файл <code>xmonad.hs</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">import</span> <span class="dt">XMonad.Util.NamedScratchpad</span></a></code></pre></div>
<p>В секцию myManageHook добавляем:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" data-line-number="1">myManageHook <span class="fu">=</span>  composeAll <span class="fu">$</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">         [ <span class="fu">...</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">         , <span class="fu">...</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">         , <span class="fu">...</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">         ]</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">         </a>
<a class="sourceLine" id="cb2-8" data-line-number="8">         <span class="fu">++</span> [namedScratchpadManageHook scratchpads]</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="fu">...</span></a></code></pre></div>
<p>Пишем правила для приложений. В нашем случае для <code>urxvt</code> и s<code>pacefm</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" data-line-number="1">scratchpads <span class="fu">=</span> [</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">            </a>
<a class="sourceLine" id="cb3-3" data-line-number="3">              <span class="dt">NS</span> <span class="st">&quot;terminal&quot;</span> <span class="st">&quot;urxvt -name scratchpad&quot;</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">                (wm_name <span class="fu">=?</span> <span class="st">&quot;scratchpad&quot;</span>)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">                (customFloating <span class="fu">$</span> <span class="dt">W.RationalRect</span> <span class="dv">0</span> <span class="fl">0.9</span> <span class="dv">1</span> <span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">              </a>
<a class="sourceLine" id="cb3-7" data-line-number="7">              <span class="dt">NS</span> <span class="st">&quot;spacefm&quot;</span> <span class="st">&quot;spacefm&quot;</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">                (className <span class="fu">=?</span> <span class="st">&quot;Spacefm&quot;</span>)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">                (customFloating <span class="fu">$</span> <span class="dt">W.RationalRect</span> <span class="dv">0</span> <span class="fl">0.6</span> <span class="dv">1</span> <span class="fl">0.4</span>),</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">            </a>
<a class="sourceLine" id="cb3-11" data-line-number="11">              ]</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">              </a>
<a class="sourceLine" id="cb3-13" data-line-number="13">              <span class="kw">where</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14">                    wm_name <span class="fu">=</span> stringProperty <span class="st">&quot;WM_NAME&quot;</span></a></code></pre></div>
<p>“Вешаем” на нужные нам клавиши:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" data-line-number="1">myKeys <span class="fu">=</span> [</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">           <span class="fu">...</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">         , ((<span class="dv">0</span>,        <span class="bn">0xffbe</span>), namedScratchpadAction scratchpads <span class="st">&quot;terminal&quot;</span>)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">         , ((mod4Mask,   xK_f), namedScratchpadAction scratchpads <span class="st">&quot;spacefm&quot;</span>)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">         <span class="fu">...</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">         ]</a></code></pre></div>
<p>Готово. Открыть, скрыть/показать терминал: <code>F1</code><br />
Открыть, скрыть/показать файловый менеджер: <code>mod4Mask+f</code><br />
Чтобы открыть терминал в обычном режиме используем клавиши по умолчанию: <code>mod4Mask+Shift+Enter</code>.</p>
<p><a href="http://www.imagebam.com/image/556917828853913"><img src="http://thumbs2.imagebam.com/49/5f/5e/556917828853913.jpg" alt="ImageBam image upload"></a></p>
<p><a href="http://www.imagebam.com/image/580398828854143"><img src="http://thumbs2.imagebam.com/e9/17/ca/580398828854143.jpg" alt="ImageBam image upload"></a></p>
<p>На самом деле окна не скрываются и не закрываются, а переносятся на скрытый рабочий стол с именем <code>NSP</code>, который будет отображаться в <code>xmobar</code>:</p>
<p><img src="http://images2.imagebam.com/81/03/6c/e6b6c5828931143.png" /></p>
<p>Таким же способом можно запускать программу в терминале. Например, у меня по <code>F2</code> запускается календарь:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" data-line-number="1">scratchpads <span class="fu">=</span> [</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">         <span class="fu">...</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">       </a>
<a class="sourceLine" id="cb5-4" data-line-number="4">         <span class="dt">NS</span> <span class="st">&quot;cal&quot;</span> <span class="st">&quot;urxvt -name cal -hold -e cal -y&quot;</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">           (wm_name <span class="fu">=?</span> <span class="st">&quot;cal&quot;</span>)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">           (customFloating <span class="fu">$</span> <span class="dt">W.RationalRect</span> <span class="fl">0.58</span> <span class="fl">0.023</span> <span class="fl">0.42</span> <span class="fl">0.82</span>),</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">         <span class="fu">...</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8">         ]</a>
<a class="sourceLine" id="cb5-9" data-line-number="9"></a>
<a class="sourceLine" id="cb5-10" data-line-number="10">myKeys <span class="fu">=</span> [</a>
<a class="sourceLine" id="cb5-11" data-line-number="11">         <span class="fu">...</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12">         , ((<span class="dv">0</span>,     <span class="bn">0xffbf</span>), namedScratchpadAction scratchpads <span class="st">&quot;cal&quot;</span>)</a>
<a class="sourceLine" id="cb5-13" data-line-number="13">         <span class="fu">...</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14">         ]</a></code></pre></div>
<p><a href="http://www.imagebam.com/image/9fae33828854383"><img src="http://thumbs2.imagebam.com/6c/52/db/9fae33828854383.jpg" alt="ImageBam image upload"></a></p>]]></description>
    <pubDate>Fri, 20 Apr 2018 00:00:00 UT</pubDate>
    <guid>https://chubaduba.github.io//posts/2018-04-20-1.html</guid>
    <dc:creator>ChubaDuba</dc:creator>
</item>
<item>
    <title>Cтрока ввода команд в Xmonad.</title>
    <link>https://chubaduba.github.io//posts/2018-04-19-1.html</link>
    <description><![CDATA[<p>Сегодня расскажу об очень удобной, на мой взгляд, фишке, которой я постоянно пользуюсь при использовании xmonad. Речь пойдёт о <font color="#92E0E2"><em>строке ввода команд</em></font>. Реализуется это двумя модулями <a href="http://hackage.haskell.org/package/xmonad-contrib-0.13/docs/XMonad-Prompt.html">XMonad.Prompt</a> и <a href="http://hackage.haskell.org/package/xmonad-contrib-0.13/docs/XMonad-Prompt-Shell.html">XMonad.Prompt.Shell</a>. Добавляем эти модули в наш <code>xmonad.hs</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">import</span> <span class="dt">XMonad.Prompt</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">import</span> <span class="dt">XMonad.Prompt.Shell</span></a></code></pre></div>
<p>Ну и, конечно, нужно задать комбинацию клавиш, при нажатии которой будет открываться строка ввода. Для себя я выбрал комбинацию <code>mod4Mask+p</code>. Добавляем её в наш конфиг:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" data-line-number="1">, ((mod4Mask,   xK_p), shellPrompt defaultXPConfig)</a></code></pre></div>
<p>После внесения всех этих изменений, при нажатии выбранной комбинации в нижней части экрана будет появляться строка ввода. Закрыть её можно нажав клавишу <code>Esc</code>:</p>
<p><a href="http://www.imagebam.com/image/b83a7b825534583"><img src="http://thumbs2.imagebam.com/bf/b6/b7/b83a7b825534583.jpg" alt="ImageBam image upload"></a></p>
<p>Мне не понравилось то, что строка открывается внизу экрана, имеет очень мелкий шрифт, и её цветовое оформление не сочетается с моими настройками. Чтобы всё это изменить, я добавил в <code>xmonad.hs</code> свою конфигурацию окна строки ввода <code>myXPConfig</code>, в которой указал нужные мне параметры:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" data-line-number="1"> <span class="co">-- Prompt</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">myXPConfig <span class="fu">=</span> defaultXPConfig</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">         { font                <span class="fu">=</span> myFont</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">         , bgColor             <span class="fu">=</span> <span class="st">&quot;#2F2F2F&quot;</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">         , fgColor             <span class="fu">=</span> <span class="st">&quot;#709180&quot;</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">         , bgHLight            <span class="fu">=</span> <span class="st">&quot;#2F2F2F&quot;</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">         , fgHLight            <span class="fu">=</span> <span class="st">&quot;#F0E0AF&quot;</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">         , promptBorderWidth   <span class="fu">=</span> <span class="dv">0</span> </a>
<a class="sourceLine" id="cb3-10" data-line-number="10">         , position            <span class="fu">=</span> <span class="dt">Top</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11">         , height              <span class="fu">=</span> <span class="dv">20</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12">         , historySize         <span class="fu">=</span> <span class="dv">100</span> </a>
<a class="sourceLine" id="cb3-13" data-line-number="13">         , historyFilter       <span class="fu">=</span> deleteConsecutive</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">         }</a></code></pre></div>
<p>Соответственно, внёс изменения для комбинации клавиш, заменив <code>defaultXPConfig</code> на <code>myXPConfig</code>. Теперь строчка в конфиге будет иметь вот такой вид:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" data-line-number="1">, ((mod4Mask,   xK_p), shellPrompt myXPConfig)</a></code></pre></div>
<p>После этих изменений всё стало так, как нужно мне:</p>
<p><a href="http://www.imagebam.com/image/fb0f65825574363"><img src="http://thumbs2.imagebam.com/6a/e0/07/fb0f65825574363.jpg" alt="ImageBam image upload"></a></p>
<p><a href="http://www.imagebam.com/image/55a8e6825581853"><img src="http://thumbs2.imagebam.com/00/71/42/55a8e6825581853.jpg" alt="ImageBam image upload"></a></p>
<p>Чтобы каждый раз не вводить в строку однотипные команды, например, команду <code>urxvt -e</code> для открытия консольного приложения в новом окне терминала, эту команду можно прописать в <code>myXPConfig</code> следующим образом:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" data-line-number="1">myXPConfig <span class="fu">=</span> defaultXPConfig</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">         { <span class="fu">...</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">         , defaultText <span class="fu">=</span> <span class="st">&quot;urxvt -e&quot;</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">         <span class="fu">...</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">         }</a></code></pre></div>
<p>Теперь при запуске строка ввода будет иметь такой вид:</p>
<p><img src="http://images2.imagebam.com/96/25/02/88856e825632023.png" /></p>
<p>На этом сегодня всё. О других способах использования строки ввода <code>XMonad.Prompt</code> я обязательно расскажу позднее.</p>]]></description>
    <pubDate>Thu, 19 Apr 2018 00:00:00 UT</pubDate>
    <guid>https://chubaduba.github.io//posts/2018-04-19-1.html</guid>
    <dc:creator>ChubaDuba</dc:creator>
</item>
<item>
    <title>Вывод в xmobar информации о доступных обновлениях.</title>
    <link>https://chubaduba.github.io//posts/2018-04-16-1.html</link>
    <description><![CDATA[<p>Xmobar сам не умеет показывать информацию о доступных обновлениях в системе, но это легко поправить с помощью скрипта.</p>
<p>Так как у меня установлен Debian, пользоваться я буду инструментом под названием <a href="https://wiki.debian.org/ru/Aptitude">aptitude</a>. Чтобы посмотреть в консоли количество доступных пакетов для обновления, необходимо сначала обновить список пакетов, выполнив в терминале команду:</p>
<pre><code># apt-get update
</code></pre>
<p>После того как список пакетов у нас обновиться, можно посмотреть количество доступных обновлений, набрав в терминале команду:</p>
<pre><code>$ aptitude search &quot;~U&quot; | wc -l
</code></pre>
<p>Как автоматизировать обновление списка пакетов командой <code>apt-get update</code> можно почитать <a href="https://chubaduba.github.io/posts/2018-04-08-1.html">тут</a>.</p>
<p>Остаётся написать скрипт который будет выводить количество возможных обновлений. После недолгих раздумий у меня получился вот такой скрипт:</p>
<hr />
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co">#! /bin/bash</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="va">NEWCOLOR=</span><span class="st">&quot;#DBA3A2&quot;</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="va">HOLDS=</span>2 </a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="va">UPDATES=$(</span><span class="ex">aptitude</span> search <span class="st">&quot;~U&quot;</span> <span class="kw">|</span> <span class="fu">wc</span> -l<span class="va">)</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="va">PKGS=$(($UPDATES</span>-<span class="va">$HOLDS))</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="kw">if</span><span class="bu"> [</span> <span class="va">$PKGS</span> <span class="ot">==</span> 0<span class="bu"> ]</span>; <span class="kw">then</span> <span class="bu">exit</span> 0</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="kw">else</span>   </a>
<a class="sourceLine" id="cb3-13" data-line-number="13">   <span class="bu">echo</span> <span class="st">&quot;&lt;fc=</span><span class="va">$NEWCOLOR</span><span class="st">&gt;updates:</span><span class="va">$PKGS</span><span class="st">&lt;/fc&gt;&quot;</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="kw">fi</span></a></code></pre></div>
<hr />
<p>В принципе, тут всё просто. Единственное, стоит обрать внимание на переменную <code>HOLDS</code>, задающую количество пакетов, которым запрещено обновляться при регулярном обновлении системы. Если у вас в системе таких пакетов нет, то данной переменной нужно присвоить значение ноль.</p>
<p>Если обновлений нет, скрипт завершает свою работу. Если обновления есть, скрипт будет выводить количество обновлений:</p>
<p><img src="http://images2.imagebam.com/dc/cd/24/8acab6821982123.png" /></p>
<p>Остаётся лишь добавить отображение результата выполнения скрипта в <code>xmobar</code>. Добавляем в <code>xmobarrc</code>:</p>
<pre><code>commands = [
                ...
                Run Com &quot;/путь_до_скрипта/updates&quot; [] &quot;updates&quot; 3600,
                ...
                ]
       ...
       , template = &quot; %StdinReader% }{ ... %updates% ...}
</code></pre>]]></description>
    <pubDate>Mon, 16 Apr 2018 00:00:00 UT</pubDate>
    <guid>https://chubaduba.github.io//posts/2018-04-16-1.html</guid>
    <dc:creator>ChubaDuba</dc:creator>
</item>

    </channel>
</rss>
