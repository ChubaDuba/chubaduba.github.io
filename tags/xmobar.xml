<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"
    xmlns:dc="http://purl.org/dc/elements/1.1/">
    <channel>
        <title>ChubaDuba - Посты с тегом xmobar</title>
        <link>https://chubaduba.github.io/</link>
        <description><![CDATA[Блог ChubaDuba]]></description>
        <atom:link href="https://chubaduba.github.io//tags/xmobar.xml" rel="self"
                   type="application/rss+xml" />
        <lastBuildDate>Thu, 02 May 2019 00:00:00 UT</lastBuildDate>
        <item>
    <title>Xmobar. Индикатор раскладки клавиатуры.</title>
    <link>https://chubaduba.github.io//posts/2019-05-02-1.html</link>
    <description><![CDATA[<p>По умолчанию <code>xmobar</code> не показывает индикатор раскладки клавиатуры, но это легко исправить, проведя несложные настройки.</p>
<p>Для начала зададим комбинацию клавиш, при нажатии которой будет переключаться язык на клавиатуре. Я по привычке использую левый <code>Alt+Shift</code>. Изменим в файле <code>/etc/default/keyboard</code> параметр <code>XKBOPTIONS</code> на то, что нам нужно:</p>
<pre><code>XKBOPTIONS=&quot;grp:alt_shift_toggle,grp_led:scroll&quot;
</code></pre>
<blockquote>
<p>Чтобы изменения вступили в силу, нужно перезагрузить систему.</p>
</blockquote>
<p>Ещё нам потребуется установить в систему пакет <a href="https://packages.debian.org/stretch/kbdd">kbdd</a>:</p>
<pre><code>$ sudo apt-get install kbdd
</code></pre>
<p>Ну и теперь остаётся настроить сам <code>xmobar</code>. Для этого открываем файл конфигурации <code>.xmobarrc</code> и добавляем в секцию <code>commands</code> строчку:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" title="1"><span class="dt">Run</span> <span class="dt">Kbd</span> [(<span class="st">&quot;us&quot;</span>, <span class="st">&quot;&lt;fc=#ffeeba&gt;usa&lt;/fc&gt;&quot;</span>), (<span class="st">&quot;ru&quot;</span>, <span class="st">&quot;&lt;fc=#ffeeba&gt;rus&lt;/fc&gt;&quot;</span>)]</a></code></pre></div>
<p>Здесь я указал каким цветом будет отображать индикатор при разных раскладках. Если вам это не нужно, параметр <code>&lt;fc&gt;&lt;/fc&gt;</code> можно не использовать.</p>
<p>В <code>template</code>, в нужном нам месте, добавляем вывод индикатора на экран:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" title="1">, template <span class="ot">=</span> <span class="op">...</span> <span class="op">%</span>kbd<span class="op">%</span> <span class="op">...</span></a></code></pre></div>
<p>Сохраняем файл <code>.xmobarrc</code> и перезагружаем <code>xmobar</code>. Теперь у нас есть индикатор раскладки:</p>
<p><a href="http://www.imagebam.com/image/7cee4e1211317614"><img src="http://thumbs2.imagebam.com/ce/2a/36/7cee4e1211317614.jpg" alt="imagebam.com"></a> <a href="http://www.imagebam.com/image/4f5c911211317634"><img src="http://thumbs2.imagebam.com/0b/dd/cd/4f5c911211317634.jpg" alt="imagebam.com"></a></p>]]></description>
    <pubDate>Thu, 02 May 2019 00:00:00 UT</pubDate>
    <guid>https://chubaduba.github.io//posts/2019-05-02-1.html</guid>
    <dc:creator>ChubaDuba</dc:creator>
</item>
<item>
    <title>Xmobar с поддержкой иконок в формате xpm.</title>
    <link>https://chubaduba.github.io//posts/2018-06-21-1.html</link>
    <description><![CDATA[<p>Сравнительно недавно в <code>xmobar</code> появилась возможность использовать иконки в формате <code>xpm</code>. Чтобы воспользоваться этим новшеством, нужно при сборке <code>xmobar</code> установить флаг <code>with_xpm</code>. Например, если устанавливать <code>xmobar</code> из <code>cabal</code>, то команда будет иметь такой вид:</p>
<pre><code>$ cabal install xmobar --flags=&quot;with_xpm&quot;
</code></pre>
<p>также для сборки потребуется установить библиотеку <code>libxpm-dev</code>:</p>
<pre><code>$ sudo apt-get install libxpm-dev
</code></pre>
<p>Для конвертации изображений в формат <code>XPM</code> можно воспользоваться <a href="https://www.online-utility.org/image/convert/to/XPM">онлайн конвертером</a>.</p>
<p>В конфигурационном файле <code>.xmobarrc</code> необходимо указать местонахождение иконок, добавив в секцию <code>Config</code> строчку:</p>
<pre><code>iconRoot = &quot;путь_до_директории_с иконками&quot;
</code></pre>
<blockquote>
<p>Также можно задать действие, которое будет выполняться по клику на иконке!</p>
</blockquote>
<p>И теперь осталось определиться с местом, где будет распологаться иконка, и, если необходимо, действие по клику. Я подготовил <a href="https://mega.nz/#!4c9kCSqa!mVtLEVM9bMsKfpMBQfmTiXCjgOyi0rDwUucD8LX5pg8">иконку</a> с логотипом <code>Debian</code> и решил расположить её в левом углу <code>xmobar</code>, а по клику на иконке будет запускаться <a href="https://chubaduba.github.io/posts/2018-02-25-1.html">myGtkMenu</a>. Редактируем <code>template</code>:</p>
<pre><code>, template = &quot;&lt;action=`ваше_действие`&gt;&lt;icon=debian_logo.xpm/&gt;&lt;/action&gt;%StdinReader% } ... 
</code></pre>
<p>Остаётся перезагрузить <code>xmobar</code> и увидеть изменения:</p>
<p><a href="http://www.imagebam.com/image/c4f5ba900960824"><img src="http://thumbs2.imagebam.com/57/78/bc/c4f5ba900960824.jpg" alt="imagebam.com"></a></p>]]></description>
    <pubDate>Thu, 21 Jun 2018 00:00:00 UT</pubDate>
    <guid>https://chubaduba.github.io//posts/2018-06-21-1.html</guid>
    <dc:creator>ChubaDuba</dc:creator>
</item>
<item>
    <title>Xmobar. Дата.</title>
    <link>https://chubaduba.github.io//posts/2018-04-27-1.html</link>
    <description><![CDATA[<p>Выкидываем из <code>~/.xmobarrc</code> стандартный <code>Run Date</code> и вставляем<br />
результат работы скрипта <code>time</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="co">#!/bin/bash</span></a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="va">DATA=</span><span class="kw">`</span><span class="fu">date</span> <span class="st">&quot;+%d.%m&quot;</span><span class="kw">`</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="va">DAY=</span><span class="kw">`</span><span class="fu">date</span> <span class="st">&quot;+%a&quot;</span><span class="kw">`</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="va">TIME=</span><span class="kw">`</span><span class="fu">date</span> <span class="st">&quot;+%H:%M&quot;</span><span class="kw">`</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">if [[</span> <span class="va">$DAY</span> <span class="ot">=</span> <span class="st">&quot;Сб&quot;</span><span class="kw"> ]]</span>; <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&#39;&lt;fc=#DBA3A2&gt;&#39;</span><span class="va">$DAY</span><span class="st">&#39;&lt;/fc&gt;&#39;</span> \</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="st">&#39;&lt;fc=#84AAD9&gt;&#39;</span><span class="va">$DATA</span><span class="st">&#39;&lt;/fc&gt;&#39;</span>  <span class="st">&#39;&lt;fc=#84AAD9&gt;&#39;</span><span class="va">$TIME</span><span class="st">&#39;&lt;/fc&gt;&#39;</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">elif [[</span> <span class="va">$DAY</span> <span class="ot">=</span> <span class="st">&quot;Вс&quot;</span><span class="kw"> ]]</span>; <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&#39;&lt;fc=#DBA3A2&gt;&#39;</span><span class="va">$DAY</span><span class="st">&#39;&lt;/fc&gt;&#39;</span> \</a>
<a class="sourceLine" id="cb1-9" title="9"><span class="st">&#39;&lt;fc=#84AAD9&gt;&#39;</span><span class="va">$DATA</span><span class="st">&#39;&lt;/fc&gt;&#39;</span>  <span class="st">&#39;&lt;fc=#84AAD9&gt;&#39;</span><span class="va">$TIME</span><span class="st">&#39;&lt;/fc&gt;&#39;</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="kw">else</span> <span class="bu">echo</span> <span class="st">&#39;&lt;fc=#84AAD9&gt;&#39;</span><span class="va">$DAY</span><span class="st">&#39;&lt;/fc&gt;&#39;</span> <span class="st">&#39;&lt;fc=#84AAD9&gt;&#39;</span><span class="va">$DATA</span><span class="st">&#39;&lt;/fc&gt;&#39;</span>  \</a>
<a class="sourceLine" id="cb1-11" title="11"><span class="st">&#39;&lt;fc=#84AAD9&gt;&#39;</span><span class="va">$TIME</span><span class="st">&#39;&lt;/fc&gt;&#39;</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="kw">fi</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="bu">exit</span> 0</a></code></pre></div>
<p>Вносим изменения в <code>~/.xmobarrc</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" title="1"><span class="op">...</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="dt">Run</span> <span class="dt">Com</span> <span class="st">&quot;/путь_до_скрипта/time&quot;</span> [] <span class="st">&quot;time&quot;</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="op">...</span></a>
<a class="sourceLine" id="cb2-4" title="4">, template <span class="ot">=</span> <span class="st">&quot; %StdinReader% }{ ...%time%... }</span></a></code></pre></div>
<p><img src="http://images2.imagebam.com/e8/22/9f/2f0e1b837743753.png" /> <img src="http://images2.imagebam.com/4b/0c/9e/76ea8b838064443.png" /></p>]]></description>
    <pubDate>Fri, 27 Apr 2018 00:00:00 UT</pubDate>
    <guid>https://chubaduba.github.io//posts/2018-04-27-1.html</guid>
    <dc:creator>ChubaDuba</dc:creator>
</item>
<item>
    <title>Xmobar. Информация о текущем треке (MOC плеер).</title>
    <link>https://chubaduba.github.io//posts/2018-04-23-1.html</link>
    <description><![CDATA[<p>Иногда бывает нужно посмотреть имя исполнителя и название трека, который в данный момент воспроизводит ваш аудиоплеер. Ниже приведён скрипт, результатом работы которого является строка, содержащая имя исполнителя и название композиции.</p>
<blockquote>
<p>Скрипт работает только в том случае, если в качестве аудиоплеера вы используете <a href="http://moc.daper.net">MOC</a>.</p>
</blockquote>
<hr />
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="co">#! /bin/bash</span></a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="va">TCOL=</span><span class="st">&quot;#8C8C8C&quot;</span>    </a>
<a class="sourceLine" id="cb1-4" title="4"><span class="va">ACOL=</span><span class="st">&quot;#E0AF8F&quot;</span>    </a>
<a class="sourceLine" id="cb1-5" title="5"><span class="va">DCOL=</span><span class="st">&quot;#637482&quot;</span>    </a>
<a class="sourceLine" id="cb1-6" title="6"><span class="va">PCOL=</span><span class="st">&quot;#4F4F4F&quot;</span>    </a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="va">MOCSTATE=$(</span><span class="ex">mocp</span> --info <span class="kw">|</span> <span class="fu">head</span> -n 1 <span class="kw">|</span> <span class="fu">tail</span> -c +8<span class="va">)</span></a>
<a class="sourceLine" id="cb1-9" title="9"></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="kw">if</span><span class="bu"> [</span> <span class="va">$MOCSTATE</span> <span class="ot">==</span> <span class="st">&quot;PLAY&quot;</span><span class="bu"> ]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb1-11" title="11">  <span class="co"># MOC на воспроизведении</span></a>
<a class="sourceLine" id="cb1-12" title="12">  <span class="bu">echo</span> <span class="st">&quot;&lt;fc=</span><span class="va">$ACOL</span><span class="st">&gt;</span><span class="va">$(</span><span class="ex">mocp</span> --info <span class="kw">|</span> <span class="fu">tail</span> -n +4 <span class="kw">|</span> <span class="fu">head</span> -n 1 <span class="kw">|</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb1-13" title="13">       <span class="fu">tail</span> -c +9<span class="va">)</span><span class="st">&lt;/fc&gt; &lt;fc=</span><span class="va">$DCOL</span><span class="st">&gt;-&lt;/fc&gt; &lt;fc=</span><span class="va">$TCOL</span><span class="st">&gt;</span><span class="va">$(</span><span class="ex">mocp</span> --info <span class="kw">|</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb1-14" title="14">       <span class="fu">tail</span> -n +5 <span class="kw">|</span> <span class="fu">head</span> -n 1 <span class="kw">|</span> <span class="fu">tail</span> -c +12<span class="va">)</span><span class="st">&lt;/fc&gt;&quot;</span></a>
<a class="sourceLine" id="cb1-15" title="15"></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="kw">elif</span><span class="bu"> [</span> <span class="va">$MOCSTATE</span> <span class="ot">==</span> <span class="st">&quot;PAUSE&quot;</span><span class="bu"> ]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb1-17" title="17">  <span class="co"># MOC на паузе</span></a>
<a class="sourceLine" id="cb1-18" title="18">  <span class="bu">echo</span> <span class="st">&quot;&lt;fc=</span><span class="va">$PCOL</span><span class="st">&gt;</span><span class="va">$(</span><span class="ex">mocp</span> --info <span class="kw">|</span> <span class="fu">tail</span> -n +4 <span class="kw">|</span> <span class="fu">head</span> -n 1 <span class="kw">|</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb1-19" title="19">       <span class="fu">tail</span> -c +9<span class="va">)</span><span class="st"> - </span><span class="va">$(</span><span class="ex">mocp</span> --info <span class="kw">|</span> <span class="fu">tail</span> -n +5 <span class="kw">|</span> <span class="fu">head</span> -n 1 <span class="kw">|</span> <span class="fu">tail</span> -c +12<span class="va">)</span><span class="st">&lt;/fc&gt;&quot;</span></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="kw">fi</span></a></code></pre></div>
<hr />
<p><a href="http://www.imagebam.com/image/2fea4c832464493"><img src="http://thumbs2.imagebam.com/7e/0c/a9/2fea4c832464493.jpg" alt="ImageBam image upload"></a></p>]]></description>
    <pubDate>Mon, 23 Apr 2018 00:00:00 UT</pubDate>
    <guid>https://chubaduba.github.io//posts/2018-04-23-1.html</guid>
    <dc:creator>ChubaDuba</dc:creator>
</item>
<item>
    <title>Вывод в xmobar информации о доступных обновлениях.</title>
    <link>https://chubaduba.github.io//posts/2018-04-16-1.html</link>
    <description><![CDATA[<p>Xmobar сам не умеет показывать информацию о доступных обновлениях в системе, но это легко поправить с помощью скрипта.</p>
<p>Так как у меня установлен Debian, пользоваться я буду инструментом под названием <a href="https://wiki.debian.org/ru/Aptitude">aptitude</a>. Чтобы посмотреть в консоли количество доступных пакетов для обновления, необходимо сначала обновить список пакетов, выполнив в терминале команду:</p>
<pre><code># apt-get update
</code></pre>
<p>После того как список пакетов у нас обновиться, можно посмотреть количество доступных обновлений, набрав в терминале команду:</p>
<pre><code>$ aptitude search &quot;~U&quot; | wc -l
</code></pre>
<p>Как автоматизировать обновление списка пакетов командой <code>apt-get update</code> можно почитать <a href="https://chubaduba.github.io/posts/2018-04-08-1.html">тут</a>.</p>
<p>Остаётся написать скрипт который будет выводить количество возможных обновлений. После недолгих раздумий у меня получился вот такой скрипт:</p>
<hr />
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" title="1"><span class="co">#! /bin/bash</span></a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="va">NEWCOLOR=</span><span class="st">&quot;#DBA3A2&quot;</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="va">HOLDS=</span>2 </a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="va">UPDATES=$(</span><span class="ex">aptitude</span> search <span class="st">&quot;~U&quot;</span> <span class="kw">|</span> <span class="fu">wc</span> -l<span class="va">)</span></a>
<a class="sourceLine" id="cb3-7" title="7"></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="va">PKGS=$(($UPDATES</span>-<span class="va">$HOLDS))</span></a>
<a class="sourceLine" id="cb3-9" title="9"></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="kw">if</span><span class="bu"> [</span> <span class="va">$PKGS</span> <span class="ot">==</span> 0<span class="bu"> ]</span>; <span class="kw">then</span> <span class="bu">exit</span> 0</a>
<a class="sourceLine" id="cb3-11" title="11"></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="kw">else</span>   </a>
<a class="sourceLine" id="cb3-13" title="13">   <span class="bu">echo</span> <span class="st">&quot;&lt;fc=</span><span class="va">$NEWCOLOR</span><span class="st">&gt;updates:</span><span class="va">$PKGS</span><span class="st">&lt;/fc&gt;&quot;</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="kw">fi</span></a></code></pre></div>
<hr />
<p>В принципе, тут всё просто. Единственное, стоит обрать внимание на переменную <code>HOLDS</code>, задающую количество пакетов, которым запрещено обновляться при регулярном обновлении системы. Если у вас в системе таких пакетов нет, то данной переменной нужно присвоить значение ноль.</p>
<p>Если обновлений нет, скрипт завершает свою работу. Если обновления есть, скрипт будет выводить количество обновлений:</p>
<p><img src="http://images2.imagebam.com/dc/cd/24/8acab6821982123.png" /></p>
<p>Остаётся лишь добавить отображение результата выполнения скрипта в <code>xmobar</code>. Добавляем в <code>xmobarrc</code>:</p>
<pre><code>commands = [
                ...
                Run Com &quot;/путь_до_скрипта/updates&quot; [] &quot;updates&quot; 3600,
                ...
                ]
       ...
       , template = &quot; %StdinReader% }{ ... %updates% ...}
</code></pre>]]></description>
    <pubDate>Mon, 16 Apr 2018 00:00:00 UT</pubDate>
    <guid>https://chubaduba.github.io//posts/2018-04-16-1.html</guid>
    <dc:creator>ChubaDuba</dc:creator>
</item>
<item>
    <title>Xmonad+xmobar+ALSA.</title>
    <link>https://chubaduba.github.io//posts/2018-03-25-1.html</link>
    <description><![CDATA[<p>Сегодня речь пойдёт о настройке в <code>xmonad</code> горячих клавиш для управления громкостью, а также о выводе в <code>xmobar</code> некоторой информации о звуковых настройках в системе.</p>
<blockquote>
<p>Всё нижеописанное справедливо для <a href="http://www.alsa-project.org/main/index.php/Main_Page">ALSA</a>.</p>
</blockquote>
<p>После того как я отказался от <a href="https://ru.wikipedia.org/wiki/Desktop_environment">DE</a> и стал использовать только <a href="https://ru.wikipedia.org/wiki/X_window_manager">WM</a>, управление громкостью сводилось к открытию <a href="https://en.wikipedia.org/wiki/Alsamixer">alsamixer</a> и последующей регулировке необходимых параметров. Скажем так, стандартный вариант у многих пользователей, которые не используют DE на своём компьютере:</p>
<p><img src="/images/alsamixer.png" /></p>
<p>Всё как бы хорошо, но согласитесь, во время просмотра какого-нибудь очередного сериальчика, для того чтобы сделать чуть потише или громче, нужно было делать все эти манипуляции. Про жену вообще молчу! Первое время фраза: “Сделай чуть погромче”, вводила её в лёгкий ступор. Поэтому я решил всё это дело как-то облагородить. Вот, что у меня получилось…</p>
<p>Первое, что пришло на ум, это назначить в xmonad горячие клавиши для быстрого запуска <code>alsamixer</code>. Сделал:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" title="1"><span class="op">...</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">import</span> <span class="dt">XMonad.Util.EZConfig</span>            (additionalKeys)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="op">...</span></a>
<a class="sourceLine" id="cb1-4" title="4">myConfig <span class="ot">=</span> defaultConfig</a>
<a class="sourceLine" id="cb1-5" title="5">         { modMask <span class="ot">=</span> mod4Mask</a>
<a class="sourceLine" id="cb1-6" title="6">         , <span class="op">...</span></a>
<a class="sourceLine" id="cb1-7" title="7">         } <span class="ot">`additionalKeys`</span> myKeys</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="op">...</span></a>
<a class="sourceLine" id="cb1-9" title="9">myKeys <span class="ot">=</span> [</a>
<a class="sourceLine" id="cb1-10" title="10">         <span class="op">...</span></a>
<a class="sourceLine" id="cb1-11" title="11">         , ((mod4Mask <span class="op">.|.</span> controlMask,    xK_a), spawn <span class="st">&quot;urxvt -e alsamixer&quot;</span>)</a>
<a class="sourceLine" id="cb1-12" title="12">         ]</a>
<a class="sourceLine" id="cb1-13" title="13"><span class="op">...</span></a></code></pre></div>
<p>По прошествии некоторого времени, в интернете было найдено решение как в xmonad назначить горячие клавиши для уменьшения (увеличения) громкости и для включения и выключения режима <code>Mute</code>. На моей<br />
клавиатуре есть специальные клавиши для громкости и для Mute. Если на вашей их нет, то назначить действия можно на любые, которые вам нравятся. Редактируем конфиг <code>xmonad</code>, добавляем наши клавиши:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" title="1"><span class="op">...</span></a>
<a class="sourceLine" id="cb2-2" title="2">myKeys <span class="ot">=</span> [</a>
<a class="sourceLine" id="cb2-3" title="3">         <span class="op">...</span></a>
<a class="sourceLine" id="cb2-4" title="4">         , ((<span class="dv">0</span>    , <span class="bn">0x1008ff11</span>), spawn <span class="st">&quot;amixer set Master 2-&quot;</span>)</a>
<a class="sourceLine" id="cb2-5" title="5">         , ((<span class="dv">0</span>    , <span class="bn">0x1008ff13</span>), spawn <span class="st">&quot;amixer set Master 2+&quot;</span>)</a>
<a class="sourceLine" id="cb2-6" title="6">         , ((<span class="dv">0</span>    , <span class="bn">0x1008ff12</span>), spawn <span class="st">&quot;amixer set Master toggle&quot;</span>)</a>
<a class="sourceLine" id="cb2-7" title="7">         ]</a>
<a class="sourceLine" id="cb2-8" title="8"><span class="op">...</span></a></code></pre></div>
<blockquote>
<p>Код нужной клавиши можно определить с помощью утилиты <a href="https://linux.die.net/man/1/xev">xev</a>, набрав в терминале команду <code>xev | grep keycode</code>, и после этого нажать нужную клавишу.</p>
</blockquote>
<p>Стало совсем хорошо! И жена уже не в ступоре :)</p>
<p>Но как говорится, аппетит приходит во время еды. Захотелось реализовать ещё несколько нужных мне фишек. Дело в том, что на данный момент у нас в хозяйстве моноблок <a href="http://static.highspeedbackbone.net/pdf/Lenovo%20C325%20All-In-One%20PC%20Data%20Sheet.pdf">Lenovo C325</a>, у которого есть встроенные динамики. Частенько бывает так, что музыку мы слушаем (а это с женой мы очень любим!) через внешний <a href="http://ldsound.ru/odissej-u-010-stereo-hi-fi/">усилитель</a> и <a href="http://ldsound.ru/75-as-001-kliver/">колонки</a>, подключая моноблок через выход на наушники к усилителю. И не раз было так, что звук идёт и через динамики моноблока, и через внешние колонки. Приходилось открывать <code>alsamixer</code> и выключать звук из динамиков моноблока. Просто, но опять же напряжно, тем более, если дома гости и т.д. Это первое, что хотелось бы сделать. Второе, вывести в <code>xmobar</code> показания уровня громкости.</p>
<p>Реализовать я это решил с помощью скриптов, а результат их работы вывести в xmobar. Первым делом написал вот такой скрипт и обозвал его <code>vol</code>:</p>
<hr />
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" title="1"><span class="co">#!/bin/bash</span></a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="va">vol=$(</span><span class="ex">amixer</span> get Master <span class="kw">|</span> <span class="fu">awk</span> -F<span class="st">&#39;[]%[]&#39;</span> <span class="st">&#39;/%/ {if ($7 == &quot;off&quot;) \</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="st">	 { print &quot;MM&quot; } else { print $2 }}&#39;</span> <span class="kw">|</span> <span class="fu">head</span> -n 1<span class="va">)</span></a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="va">COLOR=</span><span class="st">&quot;#DBA3A2&quot;</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="va">volume=</span><span class="st">&quot;[on]&quot;</span></a>
<a class="sourceLine" id="cb3-8" title="8"></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="va">Volume_s=</span><span class="st">&quot;</span><span class="kw">`</span><span class="ex">amixer</span> get Speaker Playback Volume <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;6!d&#39;</span> <span class="kw">|</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb3-10" title="10">         <span class="fu">sed</span> -r <span class="st">&#39;s/^[^B]+//&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> -r <span class="st">&#39;s/^[^[]+//&#39;</span><span class="kw">`</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb3-11" title="11"></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="va">Volume_h=</span><span class="st">&quot;</span><span class="kw">`</span><span class="ex">amixer</span> get Headphone Playback Volume <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;6!d&#39;</span> <span class="kw">|</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb3-13" title="13">         <span class="fu">sed</span> -r <span class="st">&#39;s/^[^B]+//&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> -r <span class="st">&#39;s/^[^[]+//&#39;</span><span class="kw">`</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb3-14" title="14"></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="kw">if [[</span> <span class="va">$Volume_s</span> <span class="ot">==</span> *<span class="st">&quot;</span><span class="va">$volume</span><span class="st">&quot;</span>*<span class="kw"> ]]</span> <span class="kw">&amp;&amp; [[</span> <span class="va">$Volume_h</span> <span class="ot">!=</span> *<span class="st">&quot;</span><span class="va">$volume</span><span class="st">&quot;</span>*<span class="kw"> ]]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb3-16" title="16">   <span class="bu">echo</span> <span class="st">&quot;&lt;fc=</span><span class="va">$COLOR</span><span class="st">&gt;(d)&lt;/fc&gt;&lt;fc=#8CD0D3&gt;</span><span class="va">$vol</span><span class="st">%&lt;/fc&gt;&quot;</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="kw">fi</span></a>
<a class="sourceLine" id="cb3-18" title="18"></a>
<a class="sourceLine" id="cb3-19" title="19">   <span class="kw">if [[</span> <span class="va">$Volume_s</span> <span class="ot">==</span> *<span class="st">&quot;</span><span class="va">$volume</span><span class="st">&quot;</span>*<span class="kw"> ]]</span> <span class="kw">&amp;&amp; [[</span> <span class="va">$Volume_s</span> <span class="ot">==</span> *<span class="st">&quot;</span><span class="va">$volume</span><span class="st">&quot;</span>*<span class="kw"> ]]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb3-20" title="20">   <span class="bu">echo</span> <span class="st">&quot;&lt;fc=</span><span class="va">$COLOR</span><span class="st">&gt;(dh)&lt;/fc&gt;&lt;fc=#8CD0D3&gt;</span><span class="va">$vol</span><span class="st">%&lt;/fc&gt;&quot;</span></a>
<a class="sourceLine" id="cb3-21" title="21">   <span class="kw">fi</span></a>
<a class="sourceLine" id="cb3-22" title="22"></a>
<a class="sourceLine" id="cb3-23" title="23">      <span class="kw">if [[</span> <span class="va">$Volume_s</span> <span class="ot">==</span> *<span class="st">&quot;</span><span class="va">$volume</span><span class="st">&quot;</span>*<span class="kw"> ]]</span> <span class="kw">&amp;&amp; [[</span> <span class="va">$Volume_h</span> <span class="ot">!=</span> *<span class="st">&quot;</span><span class="va">$volume</span><span class="st">&quot;</span>*<span class="kw"> ]]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb3-24" title="24">         <span class="bu">echo</span> <span class="st">&quot;&lt;fc=</span><span class="va">$COLOR</span><span class="st">&gt;(d)&lt;/fc&gt;&lt;fc=#8CD0D3&gt;</span><span class="va">$vol</span><span class="st">%&lt;/fc&gt;&quot;</span></a>
<a class="sourceLine" id="cb3-25" title="25">      <span class="kw">else</span></a>
<a class="sourceLine" id="cb3-26" title="26">           <span class="kw">if [[</span> <span class="va">$Volume_h</span> <span class="ot">==</span> *<span class="st">&quot;</span><span class="va">$volume</span><span class="st">&quot;</span>*<span class="kw"> ]]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb3-27" title="27">              <span class="bu">echo</span> <span class="st">&quot;&lt;fc=</span><span class="va">$COLOR</span><span class="st">&gt;(h)&lt;/fc&gt;&lt;fc=#8CD0D3&gt;</span><span class="va">$vol</span><span class="st">%&lt;/fc&gt;&quot;</span></a>
<a class="sourceLine" id="cb3-28" title="28">           <span class="kw">else</span></a>
<a class="sourceLine" id="cb3-29" title="29">              <span class="bu">echo</span> <span class="st">&quot;&lt;fc=#8CD0D3&gt;MM&lt;/fc&gt;&quot;</span></a>
<a class="sourceLine" id="cb3-30" title="30">           <span class="kw">fi</span></a>
<a class="sourceLine" id="cb3-31" title="31">      <span class="kw">fi</span></a>
<a class="sourceLine" id="cb3-32" title="32"></a>
<a class="sourceLine" id="cb3-33" title="33"><span class="bu">exit</span> 0</a></code></pre></div>
<hr />
<p>Этот скрипт выводит на экран текущий уровень громкости в процентах и показывает какой выходной канал является активным на данный момент. Всего может быть семь вариантов:</p>
<ul>
<li><code>(d)80%</code> - звук идёт через динамики;</li>
<li><code>(h)80%</code> - звук идёт через наушники;</li>
<li><code>(d)MM%</code> - звук идёт через динамики, режим Mute;</li>
<li><code>(h)MM%</code> - звук идёт через наушники; режим Mute;</li>
<li><code>(dh)80%</code> - звук идёт через динамики и наушники;</li>
<li><code>(dh)MM%</code> - звук идёт через динамики и наушники, режим Mute.</li>
</ul>
<blockquote>
<p>С утра, проснувшись с бодуна<br />
Mеня трясёт и глючит…<br />
© Сергей Шнуров</p>
</blockquote>
<p>Согласитесь, что в жизни всякое бывает, и такое тоже. И на этот случай я предусмотрел ещё один вариант:</p>
<ul>
<li><code>MM</code> - динамики и наушники отключены.</li>
</ul>
<p>Выводим результат работы скрипта в xmobar. Вносим изменения в файл конфигурации <code>.xmobarrc</code>:</p>
<pre><code>...
commands = [
           ...
           Run Com &quot;/путь_до_нашего_скрипта/vol&quot; [] &quot;vol&quot; 10,
           ...
           ]
...
, template = &quot; %StdinReader% }{ ... %vol% ...}
</code></pre>
<p>Теперь в xmobar’е есть информация о текущем уровне громкости и и звуковом канале. И мы можем с помощью горячих клавиш уменьшать или увеличивать громкость, либо выключить её совсем, включив режим Mute.</p>
<p>Настала очередь для второй хотелки - переключателе между выходами с динамиков на наушники и наоборот. Для этого я написал второй скрипт, обозвав его <code>alsamixer</code>:</p>
<hr />
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" title="1"><span class="co">#! /bin/bash</span></a>
<a class="sourceLine" id="cb5-2" title="2"></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="va">volume=</span><span class="st">&quot;[on]&quot;</span></a>
<a class="sourceLine" id="cb5-4" title="4"></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="va">Volume_s=</span><span class="st">&quot;</span><span class="kw">`</span><span class="ex">amixer</span> get Speaker Playback Volume <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;6!d&#39;</span> <span class="kw">|</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb5-6" title="6">         <span class="fu">sed</span> -r <span class="st">&#39;s/^[^B]+//&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> -r <span class="st">&#39;s/^[^[]+//&#39;</span><span class="kw">`</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb5-7" title="7">         </a>
<a class="sourceLine" id="cb5-8" title="8"><span class="va">Volume_h=</span><span class="st">&quot;</span><span class="kw">`</span><span class="ex">amixer</span> get Headphone Playback Volume <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;6!d&#39;</span> <span class="kw">|</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb5-9" title="9">         <span class="fu">sed</span> -r <span class="st">&#39;s/^[^B]+//&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> -r <span class="st">&#39;s/^[^[]+//&#39;</span><span class="kw">`</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb5-10" title="10"></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="kw">if [[</span> <span class="va">$Volume_s</span> <span class="ot">==</span> *<span class="st">&quot;</span><span class="va">$volume</span><span class="st">&quot;</span>*<span class="kw"> ]]</span> <span class="kw">&amp;&amp; [[</span> <span class="va">$Volume_s</span> <span class="ot">==</span> *<span class="st">&quot;</span><span class="va">$volume</span><span class="st">&quot;</span>*<span class="kw"> ]]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb5-12" title="12">   <span class="ex">amixer</span> sset Headphone mute</a>
<a class="sourceLine" id="cb5-13" title="13">   <span class="ex">amixer</span> sset Speaker unmute</a>
<a class="sourceLine" id="cb5-14" title="14"><span class="kw">fi</span></a>
<a class="sourceLine" id="cb5-15" title="15"></a>
<a class="sourceLine" id="cb5-16" title="16"></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="kw">if [[</span> <span class="va">$Volume_s</span> <span class="ot">==</span> *<span class="st">&quot;</span><span class="va">$volume</span><span class="st">&quot;</span>*<span class="kw"> ]]</span> <span class="kw">&amp;&amp; [[</span> <span class="va">$Volume_h</span> <span class="ot">!=</span> *<span class="st">&quot;</span><span class="va">$volume</span><span class="st">&quot;</span>*<span class="kw"> ]]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb5-18" title="18">   <span class="ex">amixer</span> sset Headphone unmute</a>
<a class="sourceLine" id="cb5-19" title="19">   <span class="ex">amixer</span> sset Speaker mute</a>
<a class="sourceLine" id="cb5-20" title="20"><span class="kw">else</span></a>
<a class="sourceLine" id="cb5-21" title="21"></a>
<a class="sourceLine" id="cb5-22" title="22">     <span class="kw">if [[</span> <span class="va">$Volume_h</span> <span class="ot">==</span> *<span class="st">&quot;</span><span class="va">$volume</span><span class="st">&quot;</span>*<span class="kw"> ]]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb5-23" title="23">        <span class="ex">amixer</span> sset Headphone mute</a>
<a class="sourceLine" id="cb5-24" title="24">        <span class="ex">amixer</span> sset Speaker unmute</a>
<a class="sourceLine" id="cb5-25" title="25">     <span class="kw">fi</span></a>
<a class="sourceLine" id="cb5-26" title="26"><span class="kw">fi</span></a>
<a class="sourceLine" id="cb5-27" title="27"></a>
<a class="sourceLine" id="cb5-28" title="28"><span class="bu">exit</span> 0</a></code></pre></div>
<hr />
<p>Тут всё просто. Если включены динамики, то скрипт отрабатывает на их выключение и включение наушников. Также и наоборот, с наушников на динамики. В случае, когда в <code>xmobar</code> будет значение <code>MM</code>, скрипт включит динамики. Осталось определить горячую клавишу, по нажатию которой, будет выполняться скрипт. Редактируем <code>xmonad.hs</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb6-1" title="1"><span class="op">...</span></a>
<a class="sourceLine" id="cb6-2" title="2">myKeys <span class="ot">=</span> [</a>
<a class="sourceLine" id="cb6-3" title="3">         <span class="op">...</span></a>
<a class="sourceLine" id="cb6-4" title="4">         , ((<span class="dv">0</span>   , <span class="bn">0x0</span>), spawn <span class="st">&quot;/путь_до_нашего_скрипта/alsamixer&quot;</span>)</a>
<a class="sourceLine" id="cb6-5" title="5">         <span class="op">...</span></a>
<a class="sourceLine" id="cb6-6" title="6">         ]</a></code></pre></div>
<p>На этом сегодня всё. Вопрос об управлении громкостью и её визуальном контроле в системе без использования каких-либо дополнительных программ снят.</p>]]></description>
    <pubDate>Sun, 25 Mar 2018 00:00:00 UT</pubDate>
    <guid>https://chubaduba.github.io//posts/2018-03-25-1.html</guid>
    <dc:creator>ChubaDuba</dc:creator>
</item>
<item>
    <title>Погода в xmobar</title>
    <link>https://chubaduba.github.io//posts/2018-03-15-1.html</link>
    <description><![CDATA[<h2 id="стандартный-плагин">Стандартный плагин</h2>
<p>Чтобы отобразить в <code>xmobar</code> информацию о погоде, используя его стандартный плагин, необходимо добавить в файл <code>.xmobarrc</code> следующее:</p>
<pre><code>...
commands = [
         ...
         Run Weather &quot;XXXX&quot; [&quot;-t&quot;,&quot;&lt;tempC&gt;°C&quot;] 36000,
         ...
         ]
...
, template = &quot; %StdinReader% }{ ... %weather% ... }
</code></pre>
<p>где <code>XXXX</code> - код метеостанции вашего города, согласно спецификации <a href="http://www.noaa.gov/">National Oceanic and Atmospheric Administration (NOAA)</a>. Найти код своего города можно в этом <a href="http://weather.rap.ucar.edu/surface/stations.txt">документе</a>. Нужно сказать, что код вы найдёте при одном условии: в городе, в котором вы живёте должен быть аэропорт.</p>
<p>Аргументы, которые можно использовать: <code>station</code>, <code>stationState</code>, <code>year</code>, <code>month</code>, <code>day</code>, <code>hour</code>, <code>windCardinal</code>, <code>windAzimuth</code>, <code>windMph</code>, <code>windKnots</code>, <code>windMs</code>, <code>windKmh visibility</code>,<code>skyCondition</code>, <code>tempC</code>, <code>tempF</code>, <code>dewPointC</code>, <code>dewPointF</code>, <code>rh</code>, <code>pressure</code>.</p>
<h2 id="bash-скрипт-для-вывода-погоды-в-xmobar">Bash скрипт для вывода погоды в xmobar</h2>
<p>Я живу в Ростове-на-Дону. В конце 2017 года у нас запустили в эксплуатацию новый <a href="http://platov.aero/">аэропорт Платов</a>. Код метеостанции для него я не нашёл, а информация по коду метеостанции старого аэропорта не обновляется с прошлого года. Если посмотреть <code>http://tgftp.nws.noaa.gov/data/observations/metar/decoded/URRR.TXT</code> (URRR - это код метеостанции старого аэропорта в Ростове), то увидим, что информация менялась последний раз 31.12.2017г.:</p>
<blockquote>
<p>Rostov-Na-Donu, Russia (URRR) 47-16N 039-49E 75M Dec 31, 2017 - 06:30 PM EST / 2017.12.31 2330 UTC Wind: from the S (180 degrees) at 7 MPH (6 KT):0 Visibility: less than 1 mile:0 Sky conditions: obscured Weather: light drizzle; fog; Cumulonimbus clouds observed Temperature: 42 F (6 C) Dew Point: 42 F (6 C) Relative Humidity: 100% Pressure (altimeter): 29.88 in. Hg (1012 hPa) ob: URRR 312330Z 18003MPS 0100 R04/0450N -DZ FG VV001 06/06 Q1012 R22/290056 TEMPO 0300 -SHRA FG BKN001 BKN020CB RMK QBB040 MAST OBSC QFE752/1003 cycle: 23</p>
</blockquote>
<p>Вообще, я не расстроился по этому поводу. Наблюдать в своём xmobar текущее значение температуры? Зачем? У меня есть градусник на кухне за окном, который показывает точную температуру. Зато этот повод послужил толчком к написанию скрипта, который отображал бы необходимую мне информацию о погоде.</p>
<p>Сразу скажу, что я не сторонник погодных плагинов с прогнозом на несколько дней, с кучей иконок и ненужной мне информацией типа время восхода или захода солнца. От прогноза на завтрашний день мне нужно всего два значения: дневная температура и вероятность осадков.</p>
<p>Парсить я решил RSS ленту с сайта <a href="http://old.meteoinfo.ru/">Гидрометцентра России</a>. Для начала найдём саму ленту:</p>
<p><img src="/images/2018-03-15-1.jpg" /></p>
<p><img src="/images/2018-03-15-2.jpg" /></p>
<p><img src="/images/2018-03-15-3.jpg" /></p>
<p>Теперь лента у нас есть. Как видно, в ней присутствует прогноз на три дня. Мне же нужен только завтрашний день. Пишем скрипт, который будет выдавать нам прогноз только на завтрашний день. Обзавём скрипт <code>weather</code>:</p>
<hr />
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" title="1"><span class="co">#!/bin/bash</span></a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="va">s1=</span><span class="st">&quot;OK&quot;</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="va">COLOR=</span><span class="st">&quot;#709180&quot;</span></a>
<a class="sourceLine" id="cb2-5" title="5"></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="va">CITY_URL=</span><span class="st">&quot;http://old.meteoinfo.ru/rss/forecasts/34630&quot;</span></a>
<a class="sourceLine" id="cb2-7" title="7"></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="va">SITE=</span><span class="st">&quot;</span><span class="kw">`</span><span class="ex">curl</span> -Is <span class="va">$CITY_URL</span> <span class="kw">|</span> <span class="fu">head</span> -1 <span class="kw">|</span> <span class="fu">grep</span> -Eo <span class="st">&#39;.{3}$&#39;</span><span class="kw">`</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb2-9" title="9"></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="kw">if [[</span> <span class="va">$SITE</span> <span class="ot">==</span> *<span class="st">&quot;</span><span class="va">$s1</span><span class="st">&quot;</span>*<span class="kw"> ]]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb2-11" title="11"></a>
<a class="sourceLine" id="cb2-12" title="12">     <span class="va">TOMORROW_TEMP=</span><span class="st">&quot;</span><span class="kw">`</span><span class="fu">wget</span> -O - <span class="va">$CITY_URL</span> <span class="op">2&gt;</span>/dev/null <span class="kw">|</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb2-13" title="13">              <span class="fu">grep</span> -w <span class="st">&#39;Температура&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;2!d&#39;</span> <span class="kw">|</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb2-14" title="14">              <span class="fu">sed</span> -r <span class="st">&#39;s/^[^Т]+//&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> -r <span class="st">&#39;s/^[^д]+//&#39;</span> <span class="kw">|</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb2-15" title="15">              <span class="fu">sed</span> -r <span class="st">&#39;s/°.+//&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/днём //&#39;</span><span class="kw">`</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb2-16" title="16"></a>
<a class="sourceLine" id="cb2-17" title="17">     <span class="va">POSSIBILITY_RAIN=</span><span class="st">&quot;</span><span class="kw">`</span><span class="fu">wget</span> -O - <span class="va">$CITY_URL</span> <span class="op">2&gt;</span>/dev/null <span class="kw">|</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb2-18" title="18">              <span class="fu">grep</span> -w <span class="st">&#39;Вероятность&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;2!d&#39;</span> <span class="kw">|</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb2-19" title="19">              <span class="fu">sed</span> -r <span class="st">&#39;s/^[^ф]+//&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> -r <span class="st">&#39;s/^[^к]+//&#39;</span> <span class="kw">|</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb2-20" title="20">              <span class="fu">sed</span> <span class="st">&#39;s/ков //&#39;</span> <span class="kw">|</span> <span class="fu">grep</span> -o <span class="st">&#39;^[^&lt;]*&#39;</span><span class="kw">`</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb2-21" title="21">              </a>
<a class="sourceLine" id="cb2-22" title="22">     </a>
<a class="sourceLine" id="cb2-23" title="23">     <span class="bu">echo</span> <span class="st">&quot;&lt;fc=</span><span class="va">$COLOR</span><span class="st">&gt;</span><span class="va">$TOMORROW_TEMP</span><span class="st">°C(</span><span class="va">$POSSIBILITY_RAIN</span><span class="st">)&lt;/fc&gt;&quot;</span></a>
<a class="sourceLine" id="cb2-24" title="24">     </a>
<a class="sourceLine" id="cb2-25" title="25"><span class="kw">else</span></a>
<a class="sourceLine" id="cb2-26" title="26"></a>
<a class="sourceLine" id="cb2-27" title="27">     <span class="bu">echo</span> <span class="st">&quot;n/a&quot;</span></a>
<a class="sourceLine" id="cb2-28" title="28"><span class="kw">fi</span></a></code></pre></div>
<hr />
<p>Результатом работы скрипта будет строчка:</p>
<pre><code>4°C(71%)</code></pre>
<p>где<br />
<code>4°C</code> - значение температуры;<br />
<code>(71%)</code> - вероятность осадков.</p>
<p>Остаётся добавить вывод скрипта в xmobar. Добавляем в наш <code>.xmobarrc</code> следующие:</p>
<pre><code>...
commands = [
         ...
         Run Com &quot;/путь_до_нашего_скрипта/weather&quot; [] &quot;weather&quot; 3600,
         ...
         ]
...
, template = &quot; %StdinReader% }{ ... %weather% ... }
</code></pre>
<blockquote>
<p>Отмечу один момент. Обновление выбранного мною сайта происходит один раз в день около 11:30 по Московскому времени. Поэтому, до обновления в xmobar мы видим текущие показания, а после обновления уже прогноз на завтрашний день.</p>
</blockquote>]]></description>
    <pubDate>Thu, 15 Mar 2018 00:00:00 UT</pubDate>
    <guid>https://chubaduba.github.io//posts/2018-03-15-1.html</guid>
    <dc:creator>ChubaDuba</dc:creator>
</item>
<item>
    <title>Иконки для рабочих столов xmonad в xmobar</title>
    <link>https://chubaduba.github.io//posts/2018-02-27-1.html</link>
    <description><![CDATA[<p>Какие имена у моих рабочих столов в xmonad, и в какой последовательности они расположены, я уже давно запомнил. Поэтому отображение имени рабочего стола в xmobar для меня стало лишней информацией. Было принято решение заменить имена столов на иконки, тем самым увеличить полезную площадь xmobar.</p>
<p>Для иконок мне понадобился шрифт, в котором они есть. Вариантов много, я у себя использую шрифт <a href="https://mega.nz/#!dQ1zzBqD!PeismxbJABJINXsMcUrZ3B3kScxLHFKeaeeZ_Ls__U8">Terminus Re33 Nerd</a>. Чтобы определить коды иконок, можно воспользоваться вот этим <a href="http://forall.ru-board.com/Svarga/cyr_letters_gen.html">ресурсом</a>.</p>
<p>После того как мы определили коды для всех наших выбранных иконок, вносим изменения в файл <code>xmonad.hs</code>:</p>
<p><img src="/images/2018-02-27-1.png" /></p>
<p>И теперь нужно прописать наш шрифт в файле <code>.xmobarrc</code>:</p>
<hr />
<pre><code>Config { font = &quot;xft:Terminus Re33 Nerd:size=14:weight=bold:antialias=true:hinting=true&quot;
       , additionalFonts = [ &quot;xft:Terminus Re33 Nerd:size=14:weight=bold:antialias=true:hinting=true&quot; ]
       , ...</code></pre>
<hr />
<p>После всех этих изменений в xmobar у нас будут отображаться иконки рабочих столов, вместо их названий:</p>
<p><img src="/images/2018-02-27-2.png" /></p>]]></description>
    <pubDate>Tue, 27 Feb 2018 00:00:00 UT</pubDate>
    <guid>https://chubaduba.github.io//posts/2018-02-27-1.html</guid>
    <dc:creator>ChubaDuba</dc:creator>
</item>

    </channel>
</rss>
